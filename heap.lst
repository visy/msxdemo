                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 2.9.0 #5416 (Mar 22 2009) (Mac OS X i386)
                              4 ; This file was generated Wed Feb  7 20:20:58 2018
                              5 ;--------------------------------------------------------
                              6 	.module heap
                              7 	.optsdcc -mz80
                              8 	
                              9 ;--------------------------------------------------------
                             10 ; Public variables in this module
                             11 ;--------------------------------------------------------
                             12 	.globl _malloc
                             13 ;--------------------------------------------------------
                             14 ; special function registers
                             15 ;--------------------------------------------------------
                             16 ;--------------------------------------------------------
                             17 ;  ram data
                             18 ;--------------------------------------------------------
                             19 	.area _DATA
                             20 ;--------------------------------------------------------
                             21 ; overlayable items in  ram 
                             22 ;--------------------------------------------------------
                             23 	.area _OVERLAY
                             24 ;--------------------------------------------------------
                             25 ; external initialized ram data
                             26 ;--------------------------------------------------------
                             27 ;--------------------------------------------------------
                             28 ; global & static initialisations
                             29 ;--------------------------------------------------------
                             30 	.area _HOME
                             31 	.area _GSINIT
                             32 	.area _GSFINAL
                             33 	.area _GSINIT
                             34 ;--------------------------------------------------------
                             35 ; Home
                             36 ;--------------------------------------------------------
                             37 	.area _HOME
                             38 	.area _HOME
                             39 ;--------------------------------------------------------
                             40 ; code
                             41 ;--------------------------------------------------------
                             42 	.area _CODE
                             43 ;heap.c:7: void *malloc(uint16_t size) {
                             44 ;	---------------------------------
                             45 ; Function malloc
                             46 ; ---------------------------------
   0000                      47 _malloc_start::
   0000                      48 _malloc:
   0000 DD E5                49 	push	ix
   0002 DD 21 00 00          50 	ld	ix,#0
   0006 DD 39                51 	add	ix,sp
                             52 ;heap.c:8: uint8_t *ret = heap_top;
                             53 ;heap.c:9: heap_top += size;
   0008 21r00s00             54 	ld	hl,#_heap_top
   000B 7E                   55 	ld	a,(hl)
   000C DD 86 04             56 	add	a,4 (ix)
   000F 23                   57 	inc	hl
   0010 2B                   58 	dec	hl
   0011 C5                   59 	push	bc
   0012 4F                   60 	ld	c, a
   0013 23                   61 	inc	hl
   0014 7E                   62 	ld	a, (hl)
   0015 47                   63 	ld	b, a
   0016 79                   64 	ld	a, c
   0017 2B                   65 	dec	hl
   0018 77                   66 	ld	(hl), a
   0019 78                   67 	ld	a, b
   001A C1                   68 	pop	bc
   001B DD 8E 05             69 	adc	a,5 (ix)
   001E 23                   70 	inc	hl
   001F 77                   71 	ld	(hl),a
                             72 ;heap.c:10: return (void *) ret;
   0020 DD E1                73 	pop	ix
   0022 C9                   74 	ret
   0023                      75 _malloc_end::
                             76 	.area _CODE
                             77 	.area _CABS
